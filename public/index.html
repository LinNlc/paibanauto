<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>排班助手 - 首页</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="/public/css/app.css" />
    <script>
      document.addEventListener('DOMContentLoaded', async () => {
        const statusText = document.getElementById('status-text');
        const detailText = document.getElementById('status-detail');

        try {
          const response = await fetch('/api/auth.php?action=me', {
            method: 'GET',
            credentials: 'include',
          });

          if (!response.ok) {
            window.location.href = '/public/login.html';
            return;
          }

          const data = await response.json();
          if (!data || !data.ok || !data.user) {
            window.location.href = '/public/login.html';
            return;
          }

          statusText.textContent = `欢迎回来，${data.user.display_name}`;
          detailText.textContent = '您已成功登录，可继续进行后续操作。';
        } catch (error) {
          window.location.href = '/public/login.html';
        }
      });
    </script>
  </head>
  <body class="bg-slate-950 text-slate-100">
    <div class="site-shell">
      <aside class="site-sidebar">
        <div class="site-logo">排班助手</div>
        <nav>
          <a href="#">仪表盘</a>
          <a href="#">排班表</a>
          <a href="#">团队管理</a>
        </nav>
      </aside>
      <main class="site-content flex items-center justify-center">
        <div class="text-center space-y-4">
          <h1 id="status-text" class="text-3xl font-bold tracking-wide">正在验证登录状态…</h1>
          <p id="status-detail" class="text-slate-300">请稍候。</p>
        </div>
      </main>
    </div>
  </body>
</html>
